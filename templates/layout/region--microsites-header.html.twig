{#
/**
 * @file
 * Theme override to display a region.
 *
 * Available variables:
 * - content: The content for this region, typically blocks.
 * - attributes: HTML attributes for the region <div>.
 * - region: The name of the region variable as defined in the theme's
 *   .info.yml file.
 *
 * @see template_preprocess_region()
 */
#}

{% set microsite = microsites.group.id %}
{% set microsite_fields_check = microsites.group.entity %}

{% if microsite_fields_check.lgms_main_logo.value %}
  {% set microsite_header_logo = drupal_field('lgms_main_logo', 'group', microsite, 'microsite') %}
{% endif %}
{% if microsite_fields_check.lgms_site_name.value %}
  {% set microsite_header_site_name = drupal_field('lgms_site_name', 'group', microsite, 'microsite') %}
{% endif %}
{% if microsite_fields_check.lgms_site_slogan.value %}
  {% set microsite_header_site_slogan = drupal_field('lgms_site_slogan', 'group', microsite, 'microsite') %}
{% endif %}
{% if microsite_fields_check.lgms_utility_menu.value %}
  {% set microsite_header_utility_menu = drupal_field('lgms_utility_menu', 'group', microsite, 'microsite') %}
{% endif %}
{% if microsite_fields_check.lgms_main_menu.value %}
  {% set microsite_header_main_menu = drupal_field('lgms_main_menu', 'group', microsite, 'microsite') %}
{% endif %}

{%
  set classes = [
    'lgd-region',
    'lgd-region--' ~ region|clean_class,
    'region',
    'region-' ~ region|clean_class,
    microsites.header.width.content_centered ? 'lgd-container' : '',
  ]
%}

{{ attach_library('localgov_microsites_base/header') }}

{% if content %}

  {# Begin pre-header #}
  {% if microsites.pre_header.width.content_centered %}
    <div class="lgd-container">
  {% endif %}
  <div class="microsite-header__pre-header">

    {% if microsites.pre_header.width.full_width_content_centered %}
      <div class="lgd-container padding-horizontal">
    {% endif %}
    <div class="microsite-header__search">
      <p>Search Form with <a href="#">link</a></p>
    </div>
    {% if microsites.pre_header.width.full_width_content_centered %}
      </div>
    {% endif %}
  </div>
  
  {% if microsites.pre_header.width.content_centered %}
    </div>
  {% endif %}
  {# End pre-header #}
  
  {# Begin Header #}
  <div{{ attributes.addClass(classes) }}>
    {% if microsites.header.width.full_width_content_centered %}
      <div class="lgd-container padding-horizontal">
    {% endif %}
      
    <div class="lgd-region__inner lgd-region__inner--{{ region|clean_class }}">
      {# Begin Microsite Header Main #}
      <div class="microsite-header__main">
        {% if microsite_header_logo %}
          <div class="microsite-header__logo">
            {{ microsite_header_logo }}
          </div>
        {% endif %}
        {% if microsite_header_site_name or microsite_header_site_slogan %}
          <div class="microsite-header__name-slogan">
            {% if microsite_header_site_name %}
              <div class="microsite-header__name">
                {{ microsite_header_site_name}}
              </div>
            {% endif %}
            {% if microsite_header_site_slogan %}
              <div class="microsite-header__slogan">
                {{ microsite_header_site_slogan}}
              </div>
            {% endif %}
          </div>
        {% endif %}
        {% if microsite_header_utility_menu or microsite_header_main_menu %}
          <div class="microsite-header__menus">
            {% if microsite_header_utility_menu %}
              <div class="microsite-header__menu microsite-header__menu--utility">
                {{ microsite_header_utility_menu}}
              </div>
            {% endif %}
            {% if microsite_header_main_menu %}
              <div class="microsite-header__menu microsite-header__menu--main">
                {{ microsite_header_main_menu}}
              </div>
            {% endif %}
          </div>
        {% endif %}
        <div class="microsite-header__off-canvas">
          <button class="microsite-header__off-canvas-toggle" aria-controls="#off-canvas" aria-expanded="false" aria-label="{{ 'menu toggle'|t }}">{{ 'Menu'|t }}</button>
        </div>
      </div>
      {# End Microsite Header Main #}
    </div>

    {% if microsites.footer.width.full_width_content_centered %}
      </div> 
    {% endif %}
  </div>
  {# End Header #}
{% endif %}
